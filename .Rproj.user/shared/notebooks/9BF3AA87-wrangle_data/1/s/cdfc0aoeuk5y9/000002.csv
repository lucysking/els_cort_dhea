"0","clean_tanner <- function(tan_s1T2, tan_s2T2, closest_tanner) {"
"0","  case_when("
"0","    is.na(tan_s1T2) ~ tan_s2T2,"
"0","    is.na(tan_s2T2) ~ tan_s1T2,"
"0","    closest_tanner == ""s1"" ~ tan_s1T2,"
"0","    closest_tanner == ""s2"" ~ tan_s2T2"
"0","  )"
"0","}"
"0","tanner_t2 <-"
"0","  read_sav(tanner_t2_s1_file) %>% "
"0","  left_join(read_sav(tanner_t2_s2_file), by = ""ELS_ID"") %>% "
"0","  left_join("
"0","    hormones_t2 %>% "
"0","      select(ELS_ID, date_collection),"
"0","    by = ""ELS_ID"""
"0","  ) %>% "
"0","  mutate_at("
"0","    vars(tanner_date_s1.T2, tanner_date_s2.T2),"
"0","    funs(parse_date_time(., ""Ymd""))"
"0","  ) %>% "
"0","  mutate("
"0","    date_match = case_when("
"0","      date_collection == tanner_date_s1.T2 ~ 1,"
"0","      date_collection == tanner_date_s2.T2 ~ 1,"
"0","      TRUE ~ 0"
"0","    ),"
"0","    s1_hd_diff = date_collection %--% tanner_date_s1.T2 / days(1),"
"0","    s2_hd_diff = date_collection %--% tanner_date_s2.T2 / days(1)"
"0","  ) %>% "
"0","  filter("
"0","    date_match == 1 | "
"0","      (s1_hd_diff <= 90 & s1_hd_diff >= -90) |"
"0","      (s2_hd_diff <= 90 & s2_hd_diff >= -90)"
"0","  ) %>% "
"0","  mutate("
"0","    closest_tanner = case_when("
"0","      abs(s1_hd_diff) < abs(s2_hd_diff) ~ ""s1"","
"0","      abs(s2_hd_diff) < abs(s1_hd_diff) ~ ""s2"","
"0","      s1_hd_diff == 0 ~ ""s1"","
"0","      abs(s1_hd_diff) == abs(s2_hd_diff) ~ ""s1"","
"0","      is.na(s2_hd_diff) ~ ""s1"","
"0","      is.na(s1_hd_diff) ~ ""s2"","
"0","      TRUE ~ NA_character_"
"0","    ),"
"0","    tanner_female_pubhair = clean_tanner("
"0","      tanner_female_pubhair_s1.T2,"
"0","      tanner_female_pubhair_s2.T2,"
"0","      closest_tanner"
"0","    ),"
"0","    tanner_female_breasts = clean_tanner("
"0","      tanner_female_breasts_s1.T2,"
"0","      tanner_female_breasts_s2.T2,"
"0","      closest_tanner"
"0","    ),"
"0","    tanner_male_pubhair = clean_tanner("
"0","      tanner_male_pubhair_s1.T2,"
"0","      tanner_male_pubhair_s2.T2,"
"0","      closest_tanner"
"0","    ),"
"0","    tanner_male_testes = clean_tanner("
"0","      tanner_male_testes_s1.T2,"
"0","      tanner_male_testes_s2.T2,"
"0","      closest_tanner "
"0","    )"
"0","  ) %>% "
"0","  rename("
"0","    timepoint = Timepoint.x "
"0","  ) %>% "
"0","  select("
"0","    ELS_ID,"
"0","    timepoint,"
"0","    tanner_female_pubhair:tanner_male_testes"
"0","  )"
"2","Column `ELS_ID` has different attributes on LHS and RHS of join"
"2","Column `ELS_ID` has different attributes on LHS and RHS of join"
