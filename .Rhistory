cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_abline(
data = int_slope_df,
aes(
intercept = Intercept,
slope = Slope,
color = Threat
),
size = 2
) +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
scale_color_manual(
labels = c("Lower (-1SD)", "Higher (+1SD)"),
values = c("darkblue", "darkred")
) +
scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log DHEA slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
ggsave("~/Desktop/ELS/cort_dhea/cort_dhea_sync/coupling_dhea_els.png", height = 6, width = 10)
## plot
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_yr
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_abline(
data = int_slope_df,
aes(
intercept = Intercept,
slope = Slope,
color = Threat
),
size = 2
) +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
scale_color_manual(
labels = c("Lower (-1SD)", "Higher (+1SD)"),
values = c("darkblue", "darkred")
) +
scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log DHEA slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
#extract model residuals for plotting
coupling_mod1_resid <- lm(
scale(cort_slope_yr) ~
scale(cort_clean_t1) +
scale(dhea_clean_t1),
data = cd_wf_clean
)
cd_wf_clean <-
cd_wf_clean %>%
add_residuals(coupling_mod1_resid, var = "cort_slope_resid")
#save intercepts and slopes
slope_threat_cent <-
coupling_mod1_df$`scale(dhea_slope_yr_win)_estimate`
int_threat_cent <-
coupling_mod1_df$`(Intercept)_estimate`
slope_threat_lo <-
coupling_mod_lo_df$`scale(dhea_slope_yr_win)_estimate`
int_threat_lo <-
coupling_mod_lo_df$`(Intercept)_estimate`
slope_threat_hi <-
coupling_mod_hi_df$`scale(dhea_slope_yr_win)_estimate`
int_threat_hi <-
coupling_mod_hi_df$`(Intercept)_estimate`
int_slope_df <-
tibble(
"Threat" = c("b", "a"),
"Intercept" = c(int_threat_hi, int_threat_lo),
"Slope" = c(slope_threat_hi, slope_threat_lo)
)
## plot
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_abline(
data = int_slope_df,
aes(
intercept = Intercept,
slope = Slope,
color = Threat
),
size = 2
) +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
scale_color_manual(
labels = c("Lower (-1SD)", "Higher (+1SD)"),
values = c("darkblue", "darkred")
) +
scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log DHEA slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
ggsave("~/Desktop/ELS/cort_dhea/cort_dhea_sync/coupling_dhea_els.png", height = 6, width = 10)
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_smooth(aes(color = sumsev_threat_t1 > median(sumsev_threat_t1, na.rm = TRUE)))
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_smooth(aes(color = sumsev_threat_t1 > median(sumsev_threat_t1, na.rm = TRUE)), method = "smooth") +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
scale_color_manual(
labels = c("Lower (-1SD)", "Higher (+1SD)"),
values = c("darkblue", "darkred")
) +
scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log DHEA slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_smooth(aes(color = sumsev_threat_t1 > median(sumsev_threat_t1, na.rm = TRUE)), method = "smooth") +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log DHEA slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_smooth(aes(color = sumsev_threat_t1 > median(sumsev_threat_t1, na.rm = TRUE)), method = "smooth") +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
#scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log DHEA slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_smooth(aes(color = sumsev_threat_t1 > median(sumsev_threat_t1, na.rm = TRUE)), method = "smooth")
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_smooth(aes(color = sumsev_threat_t1 > median(sumsev_threat_t1, na.rm = TRUE)), method = "lm") +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
#scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log DHEA slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
## plot
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_abline(
data = int_slope_df,
aes(
intercept = Intercept,
slope = Slope,
color = Threat
),
size = 2
) +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
scale_color_manual(
labels = c("Lower (-1SD)", "Higher (+1SD)"),
values = c("darkblue", "darkred")
) +
scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log DHEA slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
## plot
cd_wf_clean %>%
ggplot(
aes(
dhea_slope_yr_win,
cort_slope_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_abline(
data = int_slope_df,
aes(
intercept = Intercept,
slope = Slope,
color = Threat
),
size = 2
) +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
scale_color_manual(
labels = c("Lower (-1SD)", "Higher (+1SD)"),
values = c("darkblue", "darkred")
) +
#scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log DHEA slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
int_slope_df
coupling_mod1_df
coupling_mod_lo_df
int_slope_test_df
## plot
cd_wf_clean %>%
ggplot(
aes(
scale(test_slope_yr_win),
cort_slope_test_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_abline(
data = int_slope_test_df,
aes(
intercept = Intercept,
slope = Slope,
color = Threat
),
size = 2
) +
scale_x_continuous(breaks = seq.int(-2.5, 4, .5)) +
scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
scale_color_manual(
labels = c("Lower (-1SD)", "Higher (+1SD)"),
values = c("darkblue", "darkred")
) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log Testosterone slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
#extract model residuals for plotting
coupling_mod1_test_resid <- lm(
scale(cort_slope_yr) ~
scale(cort_clean_t1) +
scale(test_clean_t1),
data = cd_wf_clean
)
cd_wf_clean <-
cd_wf_clean %>%
add_residuals(coupling_mod1_test_resid, var = "cort_slope_test_resid")
#save intercepts and slopes
slope_threat_cent_test <-
coupling_mod1_test_df$`scale(test_slope_yr_win)_estimate`
int_threat_cent_test <-
coupling_mod1_test_df$`(Intercept)_estimate`
slope_threat_lo_test <-
coupling_mod_test_lo_df$`scale(test_slope_yr_win)_estimate`
int_threat_lo_test <- 2
#coupling_mod_test_lo_df$`(Intercept)_estimate`
slope_threat_hi_test <-
coupling_mod_test_hi_df$`scale(test_slope_yr_win)_estimate`
int_threat_hi_test <-
coupling_mod_test_hi_df$`(Intercept)_estimate`
int_slope_test_df <-
tibble(
"Threat" = c("b", "a"),
"Intercept" = c(int_threat_hi_test, int_threat_lo_test),
"Slope" = c(slope_threat_hi_test, slope_threat_lo_test)
)
## plot
cd_wf_clean %>%
ggplot(
aes(
scale(test_slope_yr_win),
cort_slope_test_resid
)
) +
geom_point(alpha = 1/2, aes(shape = male, size = sumsev_threat_t1)) +
geom_abline(
data = int_slope_test_df,
aes(
intercept = Intercept,
slope = Slope,
color = Threat
),
size = 2
) +
scale_x_continuous(breaks = seq.int(-2.5, 4, .5)) +
scale_y_continuous(breaks = seq.int(-2, 2.5, .5)) +
scale_shape_manual(
labels = NULL,
values = c(2, 1)
) +
guides(shape = FALSE, size = FALSE) +
scale_color_manual(
labels = c("Lower (-1SD)", "Higher (+1SD)"),
values = c("darkblue", "darkred")
) +
theme_apa(base_size = 20) +
labs(
shape = NULL,
size = NULL,
color = "Threat severity",
x = "log Testosterone slope from T1 to T2",
y = "log Cortisol slope from T1 to T2\n(standardized residuals)"
)
ggsave("~/Desktop/ELS/cort_dhea/cort_dhea_sync/coupling_test_els.png", height = 6, width = 10)
all_els_demo <-
read_csv(els_file) %>%
select(ELS_ID, sumsev_threat_t1, sumsev_threat_t2, sumsev_type_t1) %>%
left_join(
read_csv(demo_file, na = c("999", "888")) %>%
filter(timepoint == "T1"),
by = "ELS_ID"
) %>%
left_join(distinct_IDs_all, by = "ELS_ID") %>%
mutate(
included = if_else(
is.na(included), 0, included
)
) %>%
mutate_at(
vars(bmi, inr_t1),
as.double
) %>%
left_join(
read_csv(tanner_file) %>%
filter(timepoint == "T1", early_puberty == TRUE) %>%
distinct(ELS_ID, tanner_av, .keep_all = TRUE),
by = "ELS_ID"
) %>%
distinct(ELS_ID, sumsev_threat_t1, .keep_all = TRUE)
cd_wf_clean <-
cd_wf_clean %>%
mutate(
nonthreat_t1 = sumsev_type_t1 - sumsev_threat_t1
)
coupling_mod1_nonthreat <- lm(
scale(cort_slope_yr) ~
scale(dhea_slope_yr_win) *
scale(nonthreat_t1) +
scale(cort_clean_t1) +
scale(dhea_clean_t1),
data = cd_wf_clean
)
summary(coupling_mod1)
summary(coupling_mod1_nonthreat)
coupling_mod1_nonthreat <- lm(
scale(cort_slope_yr) ~
scale(dhea_slope_yr_win) *
scale(sumsev_type_t1) +
scale(cort_clean_t1) +
scale(dhea_clean_t1),
data = cd_wf_clean
)
summary(coupling_mod1_nonthreat)
coupling_mod1_nonthreat <- lm(
scale(cort_slope_yr) ~
scale(dhea_slope_yr_win) *
scale(nonthreat_t1) +
scale(cort_clean_t1) +
scale(dhea_clean_t1),
data = cd_wf_clean
)
summary(coupling_mod1_nonthreat)
read_csv(severity_file) %>%
filter(ELS_ID %in% included_IDs) %>%
filter(timepoint == "T2") %>%
group_by(event, timepoint) %>%
summarise_at(
vars(rating),
list(~sum(!is.na(.)), ~(sum(!is.na(.))/143)*100,  ~mean, ~sd)
) %>%
arrange(timepoint)
confint(coupling_mod1_nonthreat)
coupling_mod1_nonthreat_test <- lm(
scale(cort_slope_yr) ~
scale(test_slope_yr_win) *
scale(nonthreat_t1) +
scale(cort_clean_t1) +
scale(test_clean_t1),
data = cd_wf_clean
)
summary(coupling_mod1_nonthreat_test)
confint(coupling_mod1_nonthreat_test)
summary(coupling_mod1_nonthreat_test)
confint(coupling_mod1_nonthreat_test)
